<h2>Liste des Factures</h2>

<div class="actions" *ngIf="role !== 'patient'">
  <button routerLink="/facture/create" class="btn-primary">
    Créer une Facture
  </button>
</div>

<!-- Search Section (date filter removed) -->
<div class="search-container">
  <input
    type="text"
    placeholder="Rechercher par nom de patient ou médecin..."
    class="search-input"
    [value]="search"
    (input)="onSearchChange($any($event.target).value)"
  />
</div>

<div *ngIf="loading" class="loading">
  Chargement...
</div>

<div class="list-container" *ngIf="!loading">

  <!-- Empty state -->
  <div *ngIf="factures.length === 0" class="empty-message">
    Aucune facture disponible.
  </div>

  <!-- Facture cards -->
  <div class="list-item" *ngFor="let f of factures">
    <div class="info">
      <h3>Facture #{{ f.bill.id }}</h3>

      <p>
        Patient :
        {{ f.patient?.firstName }} {{ f.patient?.lastName || '' }}
      </p>

      <p>
        Médecin :
        {{ f.doctor?.firstName }} {{ f.doctor?.lastName }}
      </p>

      <p>Spécialité : {{ f.doctor?.specialty }}</p>
      <p>Montant : {{ f.bill.amount }} DH</p>
      <p>Date : {{ f.bill.billDate }}</p>
    </div>

    <div class="item-actions">
      <button
        [routerLink]="['/facture/generate', f.bill.id]"
        class="btn-primary">
        Générer
      </button>

      <button
        *ngIf="role !== 'patient'"
        (click)="deleteFacture(f.bill.id)"
        class="btn-danger">
        Supprimer
      </button>
    </div>
  </div>
</div>
